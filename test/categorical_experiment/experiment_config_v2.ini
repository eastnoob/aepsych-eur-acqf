# AEPsych配置文件 - 分类/有序离散变量实验 (改进版V2)
#
# 实验: UI设计偏好评估
# 设计空间: 5×4×6×3 = 360种组合
# 采样预算: 80次 (约22%的空间)
# 变量类型: 全部为分类或有序离散
#
# 改进要点:
# 1. 使用增强型采集函数 (EnhancedVarianceReductionAcqf)
# 2. 避免重复采样 - 重复设计得分降至1%
# 3. 强化空间覆盖 - 多样性权重从0.8降至0.2
# 4. 分区均匀性 - 对稀疏分区提升权重
# 5. 动态策略 - 主效应收敛后增强交互效应探索
# 6. 适度exploration - UCB-like奖励高不确定性区域

[common]
parnames = [color_scheme, layout, font_size, animation]
outcome_types = [continuous]
strategy_names = [init_strat, opt_strat]

# 分类变量: 色彩方案 (5种)
[color_scheme]
par_type = categorical
choices = [blue, green, red, purple, orange]

# 分类变量: 布局类型 (4种)
[layout]
par_type = categorical
choices = [grid, list, card, timeline]

# 有序离散变量: 字体大小 (6级)
[font_size]
par_type = integer
lower_bound = 12
upper_bound = 22
# 实际可选值: 12, 14, 16, 18, 20, 22 (步长=2)

# 分类变量: 动画效果 (3种)
[animation]
par_type = categorical
choices = [none, subtle, dynamic]

# 阶段1: 初始化采样 (20次)
# 使用随机采样覆盖空间
[init_strat]
min_asks = 20
min_total_tells = 0
generator = RandomGenerator

# 阶段2: 主动学习优化 (60次)
# 使用改进的采集函数智能选点
[opt_strat]
min_asks = 60
min_total_tells = 20
generator = AcqfGridSearchGenerator
model = GPRegressionModel
min_post_range = 0.95

# GP回归模型配置
[GPRegressionModel]
inducing_size = 50
mean_covar_factory = default_mean_covar_factory

# 网格搜索优化器配置
[AcqfGridSearchGenerator]
acqf = EnhancedVarianceReductionAcqf
samps = 1000
# 从1000个候选点中选择最佳

# 改进的采集函数配置
[EnhancedVarianceReductionAcqf]
# === 信息增益相关 ===
lambda_main = 1.0              # 主效应权重（固定）
lambda_inter = 0.5             # 交互效应初始权重
lambda_inter_max = 3.0         # 交互效应最大权重（主效应收敛后）
tau_main = 0.3                 # 主效应方差阈值（低于此值时增强交互效应）
tau_inter = 0.5                # 交互效应方差阈值（高于此值时降低交互效应）

# === 多样性和覆盖相关 ===
gamma_diversity = 0.8          # 多样性初始权重（早期exploration）
gamma_diversity_min = 0.2      # 多样性最小权重（后期exploitation）
gamma_binning = 0.4            # 分区均匀性权重（对稀疏分区提升采样）
gamma_exploration = 0.3        # 探索奖励权重（UCB-like，前期高后期低）
beta_ucb = 0.15                # UCB exploration参数（控制不确定性奖励强度）

# === 重复惩罚 ===
penalty_repeat = 0.01          # 重复采样惩罚系数（已采样设计得分降至1%）

# === 分区设置 ===
n_bins = 5                     # 因变量分区数量（1-3, 3-5, 5-7, 7-9, 9-11）

# === 覆盖度方法 ===
coverage_method = min_distance # Gower距离计算方法

# === 交互项配置 ===
# color-layout (0,1): 颜色与布局的交互
# layout-animation (1,3): 布局与动画的交互  
# font-animation (2,3): 字体与动画的交互
interaction_terms = (0,1);(1,3);(2,3)

# === GP参数 ===
noise_variance = 1.0           # GP噪声方差
prior_variance = 1.0           # 参数先验方差
