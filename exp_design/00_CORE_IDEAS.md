# 核心设计思路（快速理解版）

## 🎯 实验目标

- **30个被试** × **25-30次采样** = 750-900个数据点
- **6个因子**（混合变量类型）
- **15个潜在交互对** C(6,2) = 15
- **个体差异**：每个被试的心理函数可能不同

---

## 💡 核心理念：两阶段分离

```
┌─────────────────────┐
│  采样阶段           │  GP模型 + 自适应采集函数
│  "在哪里采样"       │  → 最大化信息增益
└─────────────────────┘

┌─────────────────────┐
│  分析阶段           │  混合效应线性模型
│  "效应有多大"       │  → 统计推断（p值、置信区间）
└─────────────────────┘
```

**为什么分离？**
- GP擅长探索-利用平衡（找高价值采样点）
- 线性模型擅长统计推断（估计效应、检验显著性）
- 每个被试独立建模（避免过拟合，尊重个体差异）

---

## 📐 三阶段流程

### 阶段1：预热 Meta-learning（8人 × 20次）

**目的**：筛选"有希望"的交互对，避免浪费样本

```
方法：Maximin LHS（Space-filling）
  ↓
拟合初步混合模型
  ↓
筛选：p < 0.10 的交互对（5-7个）
  ↓
确定：采集函数超参数（λ_max, tau_n_max等）
```

**为什么用Space-filling？**
- 均匀覆盖 → 主效应估计准确
- 无偏基线 → 交互检测可靠
- 与动态机制协同 → r_t快速下降

### 阶段2：主动学习（20人 × 30次）

**每个被试的采样**：
- **前5次**：随机采样（避免主动学习偏差）
- **后25次**：GP主动采样（高效探索交互）

**采集函数配置**：
```python
interaction_pairs = [预热中筛选的5-7个交互对]
lambda_max = [从预热学到的值]
tau_n_max = 21  # 70%位置转向精细化
```

**动态权重机制**：
```
样本1-5（随机）  → r_t ≈ 1.0 → λ_t ≈ 0.1 → 探索主效应
样本6-21（主动） → r_t ↓ 0.3 → λ_t ↑ 1.0 → 探索交互
样本22-30（主动）→ γ_t ↓ 0.05 → 聚焦精细化
```

### 阶段3：验证（可选，2人 × 30次）

**目的**：检查主动学习是否引入偏差

```
纯随机采样 60个样本
  ↓
拟合验证模型
  ↓
对比：主模型 vs 验证模型的系数
  ↓
差异 < 20% → 可接受
```

---

## 📊 最终分析：混合效应模型

```python
# 固定效应：主效应 + 显著交互
y ~ x0 + x1 + ... + x5 + x0:x1 + x2:x5 + ...

# 随机效应：个体差异
  + (1 + x0 + ... + x5 | subject_id)
```

**输出**：
- 主效应系数 ± 标准误
- 交互效应系数 ± 标准误
- p值、95%置信区间
- 随机效应方差（个体差异）

---

## 🔑 关键决策

| 问题 | 答案 | 原因 |
|------|------|------|
| 预热策略？ | **策略A：纯Space-filling** | 主效应准确 → r_t↓ → λ_t自动↑ |
| 交互对配置？ | **从预热筛选5-7个** | 避免浪费在不存在的交互上 |
| 每个被试建模？ | **独立GP模型** | 尊重个体差异，避免过拟合 |
| 随机样本？ | **前5次随机** | 避免主动学习偏差（占17%） |
| 最终推断？ | **混合线性模型** | 标准统计推断（p值、CI） |

---

## 📦 样本预算

| 阶段 | 被试 | 采样 | 总计 | 占比 |
|------|------|------|------|------|
| 预热 | 8 | 20（LHS） | 160 | 20% |
| 主动 | 20 | 5随机+25主动 | 600 | 73% |
| 验证 | 2 | 30（随机） | 60 | 7% |
| **总计** | **30** | - | **820** | **100%** |

---

## ⚡ 快速检查清单

**预热阶段前**：
- [ ] 确认6个因子的类型和范围
- [ ] 生成LHS样本（8人×20次）
- [ ] 配置GP模型（核函数、似然）

**预热阶段后**：
- [ ] 拟合初步混合模型
- [ ] 筛选交互对（p<0.10）
- [ ] 确定采集函数超参数

**主动学习中**：
- [ ] 每个被试独立建模
- [ ] 前5次随机采样
- [ ] 监控λ_t、γ_t变化

**数据分析时**：
- [ ] 整合所有数据
- [ ] 拟合最终混合模型
- [ ] 报告APA格式结果

---

## 📖 详细文档索引

- **预热方案详解**：`01_WARMUP_STRATEGY.md`
- **完整实验设计**：`../EXPERIMENT_DESIGN.md`
- **策略对比分析**：`../strategy_matrix_critique.md`
- **预热代码示例**：`../warmup_strategy_example.py`
